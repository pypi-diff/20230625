# Comparing `tmp/aironsuit-0.1.8-py3-none-any.whl.zip` & `tmp/aironsuit-0.1.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,19 +1,19 @@
-Zip file size: 13175 bytes, number of entries: 17
--rw-rw-r--  2.0 unx        0 b- defN 21-Aug-14 19:26 aironsuit/__init__.py
--rw-rw-r--  2.0 unx      183 b- defN 21-Aug-14 19:26 aironsuit/backend.py
--rw-rw-r--  2.0 unx        0 b- defN 21-Aug-14 19:26 aironsuit/model_designers.py
--rw-rw-r--  2.0 unx    18599 b- defN 21-Nov-01 22:30 aironsuit/suit.py
--rw-rw-r--  2.0 unx       44 b- defN 21-Aug-14 19:26 aironsuit/callbacks/__init__.py
--rw-rw-r--  2.0 unx     1400 b- defN 21-Nov-01 22:34 aironsuit/callbacks/callbacks.py
--rw-rw-r--  2.0 unx     1763 b- defN 21-Nov-01 22:34 aironsuit/callbacks/callbacks_tf.py
--rw-rw-r--  2.0 unx     1102 b- defN 21-Nov-01 21:09 aironsuit/callbacks/callbacks_torch.py
--rw-rw-r--  2.0 unx       42 b- defN 21-Aug-14 19:26 aironsuit/trainers/__init__.py
--rw-rw-r--  2.0 unx     2242 b- defN 21-Nov-01 22:34 aironsuit/trainers/trainers.py
--rw-rw-r--  2.0 unx      830 b- defN 21-Nov-01 14:30 aironsuit/trainers/trainers_tf.py
--rw-rw-r--  2.0 unx     1646 b- defN 21-Oct-30 11:53 aironsuit/trainers/trainers_torch.py
--rw-rw-r--  2.0 unx     1525 b- defN 21-Nov-02 08:23 aironsuit-0.1.8.dist-info/LICENSE
--rw-rw-r--  2.0 unx     4433 b- defN 21-Nov-02 08:23 aironsuit-0.1.8.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 21-Nov-02 08:23 aironsuit-0.1.8.dist-info/WHEEL
--rw-rw-r--  2.0 unx       10 b- defN 21-Nov-02 08:23 aironsuit-0.1.8.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1420 b- defN 21-Nov-02 08:23 aironsuit-0.1.8.dist-info/RECORD
-17 files, 35331 bytes uncompressed, 10821 bytes compressed:  69.4%
+Zip file size: 13281 bytes, number of entries: 17
+-rw-rw-r--  2.0 unx        0 b- defN 21-Nov-05 18:05 aironsuit/__init__.py
+-rw-rw-r--  2.0 unx      183 b- defN 21-Nov-05 18:05 aironsuit/backend.py
+-rw-rw-r--  2.0 unx        0 b- defN 21-Nov-05 18:05 aironsuit/model_designers.py
+-rw-rw-r--  2.0 unx    18882 b- defN 21-Nov-16 19:32 aironsuit/suit.py
+-rw-rw-r--  2.0 unx       44 b- defN 21-Nov-05 18:05 aironsuit/callbacks/__init__.py
+-rw-rw-r--  2.0 unx     1390 b- defN 21-Nov-15 15:47 aironsuit/callbacks/callbacks.py
+-rw-rw-r--  2.0 unx     1763 b- defN 21-Nov-15 15:47 aironsuit/callbacks/callbacks_tf.py
+-rw-rw-r--  2.0 unx     1102 b- defN 21-Nov-15 15:47 aironsuit/callbacks/callbacks_torch.py
+-rw-rw-r--  2.0 unx       42 b- defN 21-Nov-05 18:05 aironsuit/trainers/__init__.py
+-rw-rw-r--  2.0 unx     2321 b- defN 21-Nov-16 19:53 aironsuit/trainers/trainers.py
+-rw-rw-r--  2.0 unx      830 b- defN 21-Nov-15 17:09 aironsuit/trainers/trainers_tf.py
+-rw-rw-r--  2.0 unx     1691 b- defN 21-Nov-16 19:55 aironsuit/trainers/trainers_torch.py
+-rw-rw-r--  2.0 unx     1525 b- defN 21-Nov-16 23:03 aironsuit-0.1.9.dist-info/LICENSE
+-rw-rw-r--  2.0 unx     4408 b- defN 21-Nov-16 23:03 aironsuit-0.1.9.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 21-Nov-16 23:03 aironsuit-0.1.9.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       10 b- defN 21-Nov-16 23:03 aironsuit-0.1.9.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     1420 b- defN 21-Nov-16 23:03 aironsuit-0.1.9.dist-info/RECORD
+17 files, 35703 bytes uncompressed, 10927 bytes compressed:  69.4%
```

## zipnote {}

```diff
@@ -30,23 +30,23 @@
 
 Filename: aironsuit/trainers/trainers_tf.py
 Comment: 
 
 Filename: aironsuit/trainers/trainers_torch.py
 Comment: 
 
-Filename: aironsuit-0.1.8.dist-info/LICENSE
+Filename: aironsuit-0.1.9.dist-info/LICENSE
 Comment: 
 
-Filename: aironsuit-0.1.8.dist-info/METADATA
+Filename: aironsuit-0.1.9.dist-info/METADATA
 Comment: 
 
-Filename: aironsuit-0.1.8.dist-info/WHEEL
+Filename: aironsuit-0.1.9.dist-info/WHEEL
 Comment: 
 
-Filename: aironsuit-0.1.8.dist-info/top_level.txt
+Filename: aironsuit-0.1.9.dist-info/top_level.txt
 Comment: 
 
-Filename: aironsuit-0.1.8.dist-info/RECORD
+Filename: aironsuit-0.1.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## aironsuit/suit.py

```diff
@@ -1,25 +1,23 @@
-import numpy as np
 import os
-from hyperopt import Trials, STATUS_OK, STATUS_FAIL
-import hyperopt
-from sklearn import metrics
+import numpy as np
 import pandas as pd
 import pickle
 import math
 import tempfile
-from sklearn.metrics import accuracy_score
 from inspect import getfullargspec
+import hyperopt
+from hyperopt import Trials, STATUS_OK, STATUS_FAIL
+from sklearn.metrics import accuracy_score, roc_curve, auc
 from aironsuit.trainers import AIronTrainer
 from aironsuit.callbacks import init_callbacks, get_basic_callbacks
 from aironsuit.backend import get_backend
-from airontools.model_constructors import Model, get_latent_model
+from airontools.constructors.utils import Model, get_latent_model
 from airontools.visualization import get_insights
-from airontools.model_interactors import load_model, save_model, clear_session, summary
-
+from airontools.interactors import load_model, save_model, clear_session, summary
 BACKEND = get_backend()
 
 
 class AIronSuit(object):
     """ AIronSuit is a model wrapper that takes care of the hyper-parameter optimization problem, training and inference
     among other functionalities.
 
@@ -148,24 +146,26 @@
             elif metric == 'i_auc':  # ToDo: make this work
                 y_pred = self.model.predict(x_val)
                 if not isinstance(y_pred, list):
                     y_pred = [y_pred]
                 exp_loss = []
                 for i in np.arange(0, self.__total_n_models):
                     if len(np.bincount(y_val[i][:, -1])) > 1 and not math.isnan(np.sum(y_pred[i])):
-                        fpr, tpr, thresholds = metrics.roc_curve(y_val[i][:, -1], y_pred[i][:, -1])
-                        exp_loss += [(1 - metrics.auc(fpr, tpr))]
+                        fpr, tpr, thresholds = roc_curve(y_val[i][:, -1], y_pred[i][:, -1])
+                        exp_loss += [(1 - auc(fpr, tpr))]
                 exp_loss = np.mean(exp_loss) if len(exp_loss) > 0 else 1
             else:
-                if y_val:
+                if y_val is not None:
                     exp_loss = self.model.evaluate(x_val, y_val)
                 else:
                     exp_loss = self.model.evaluate(x_val)
-                if isinstance(exp_loss, list):
+                if isinstance(exp_loss, list) or isinstance(exp_loss, tuple):
                     exp_loss = exp_loss[0]
+                if isinstance(exp_loss, dict):
+                    exp_loss = [loss for _, loss in exp_loss.items()][0]
 
             if verbose > 0:
                 print('\n')
                 print('Exploration Loss: ', exp_loss)
             status = STATUS_OK if not math.isnan(exp_loss) and exp_loss is not None else STATUS_FAIL
 
             # Save trials
@@ -175,16 +175,17 @@
             # Save model if it is the best so far
             best_exp_losss_name = os.path.join(path, '_'.join(['best', name, 'exp_loss']))
             trials_losses = [loss_ for loss_ in trials.losses() if loss_]
             best_exp_loss = min(trials_losses) if len(trials_losses) > 0 else None
             print('best val loss so far: ' + str(best_exp_loss))
             print('current val loss: ' + str(exp_loss))
             best_exp_loss_cond = best_exp_loss is None or exp_loss < best_exp_loss
-            print('save: ' + str(status and best_exp_loss_cond))
-            if status == STATUS_OK and best_exp_loss_cond:
+            save_cond = status == STATUS_OK and best_exp_loss_cond
+            print('save: ' + str(save_cond))
+            if save_cond:
                 df = pd.DataFrame(data=[exp_loss], columns=['best_exp_loss'])
                 df.to_pickle(best_exp_losss_name)
                 self.__save_load_model(name=os.path.join(path, '_'.join(['best_exp', name])), mode='save')
                 with open(os.path.join(path, '_'.join(['best_exp', name, 'hyper_candidates'])), 'wb') as f:
                     pickle.dump(hyper_candidates, f, protocol=pickle.HIGHEST_PROTOCOL)
                 if val_inference_in_path is not None:
                     y_val_ = np.concatenate(y_val, axis=1) if isinstance(y_val, list) else y_val
@@ -215,15 +216,15 @@
 
             # Best model
             specs = {}
             if model_specs:
                 specs.update(model_specs.copy())
             specs.update(best_hyper_candidates)
             best_model = self.__save_load_model(name=os.path.join(path, '_'.join(['best_exp', name])), mode='load',
-                                                **{key:value for key, value in specs.items() if key != 'name'})
+                                                **{key: value for key, value in specs.items() if key != 'name'})
             if BACKEND == 'tensorflow' and all([spec_ in specs.keys() for spec_ in ['optimizer', 'loss']]):
                 best_model.compile(optimizer=specs['optimizer'], loss=specs['loss'])
             elif cuda:
                 best_model.cuda()
             print('best hyper-parameters: ' + str(best_hyper_candidates))
 
             # Trainer
@@ -302,22 +303,26 @@
 
             Parameters:
                 hidden_layer_names (str): Layer names.
         """
         assert self.model is not None
         self.latent_model = get_latent_model(self.model, hidden_layer_names)
 
-    def evaluate(self, x, y, use_trainer=False):
+    def evaluate(self, x, y=None, use_trainer=False):
         """ Evaluate.
 
             Parameters:
-                x (list, np.array): Input data for training.
+                x (list, np.array): Input data for evaluation.
+                y (list, np.array): Target data for evaluation.
                 use_trainer (bool): Whether to use the current trainer or not.
         """
-        return self.__get_model_interactor(use_trainer).evaluate(x, y)
+        args = [x]
+        if y is not None:
+            args += [y]
+        return self.__get_model_interactor(use_trainer).evaluate(*args)
 
     def save_model(self, name):
         """ Save the model.
 
             Parameters:
                 name (str): Model name.
         """
@@ -362,15 +367,17 @@
         if mode == 'save':
             if self.__force_subclass_weights_saver:
                 self.model.save_weights(name)
             else:
                 save_model(model=self.model, name=name)
         elif mode == 'load':
             if self.__force_subclass_weights_loader:
-                return self.__model_constructor(**kwargs).load_weights(name)
+                model = self.__model_constructor(**kwargs)
+                model.load_weights(name)
+                return model
             else:
                 return load_model(name, custom_objects=self.__custom_objects)
 
     def __train(self, train_specs, model, epochs, x_train, y_train, x_val=None, y_val=None, callbacks=None,
                 verbose=None):
         trainer_kwargs = train_specs.copy()
         trainer_kwargs.update({'module': model})
@@ -380,16 +387,15 @@
         trainer_fullargspec = list(getfullargspec(trainer.fit))[0]
         train_kwargs = {}
         if not any([val_ is None for val_ in [x_val, y_val]]) and \
                 all([val_ in trainer_fullargspec for val_ in ['x_val', 'y_val']]):
             train_kwargs.update({'x_val': x_val, 'y_val': y_val})
         train_kwargs.update({'epochs': epochs})
         for karg, val in zip(['verbose'], [verbose]):
-            if karg in trainer_fullargspec:
-                train_kwargs.update({'verbose': val})
+            train_kwargs.update({karg: val})
         trainer.fit(x_train, y_train, **train_kwargs)
         return trainer
 
     def __get_model_interactor(self, use_trainer):
         if use_trainer:
             if self.__trainer:
                 instance = self.__trainer
```

## aironsuit/callbacks/callbacks.py

```diff
@@ -1,8 +1,7 @@
-import os
 import glob
 from aironsuit.backend import get_backend
 BACKEND = get_backend()
 if BACKEND == 'pytorch':
     from aironsuit.callbacks.callbacks_torch import *
 else:
     from aironsuit.callbacks.callbacks_tf import *
```

## aironsuit/callbacks/callbacks_tf.py

 * *Ordering differences only*

```diff
@@ -1,10 +1,10 @@
+import os
 import tempfile
 from tensorflow.keras import callbacks
-import os
 
 
 def get_basic_callbacks(path=tempfile.gettempdir(), patience=3, name=None, verbose=0, epochs=None):
     basic_callbacks = []
     name = name if name else 'NN'
     basic_callbacks.append({'TensorBoard':
                                 {'callback': callbacks.TensorBoard,
```

## aironsuit/callbacks/callbacks_torch.py

 * *Ordering differences only*

```diff
@@ -1,10 +1,10 @@
+import os
 import tempfile
 from skorch import callbacks
-import os
 
 
 def get_basic_callbacks(path=tempfile.gettempdir(), patience=3, name=None, verbose=0, epochs=None):
     basic_callbacks = []
     name = name if name is not None else 'NN'
     basic_callbacks.append({'LRScheduler':
                                 {'callback': callbacks.LRScheduler,
```

## aironsuit/trainers/trainers.py

```diff
@@ -26,24 +26,25 @@
         self.best_module_name = None
         self.__class_weight = kwargs['class_weight'] if 'class_weight' in kwargs else None
         self.__path = kwargs['path'] if 'path' in kwargs else None
 
     def __setattr__(self, key, value):
         self.__dict__[key] = value
 
-    def fit(self, x_train, y_train, x_val=None, y_val=None, **kwargs):
+    def fit(self, x_train, y_train, x_val=None, y_val=None, verbose=0, **kwargs):
         """ Module for fitting.
 
             Parameters:
                 x_train (list, np.array): Input data for training.
                 y_train (list, np.array): Output data for training.
                 x_val (list, np.array): Input data for validation.
                 y_val (list, np.array): Output data for validation.
+                verbose (int): Level of verbosity.
         """
-        fit(module=self.module, x_train=x_train, y_train=y_train, x_val=x_val, y_val=y_val, **kwargs)
+        fit(module=self.module, x_train=x_train, y_train=y_train, x_val=x_val, y_val=y_val, verbose=verbose, **kwargs)
 
     def evaluate(self, x_val, y_val):
         """ Module for evaluation.
 
             Parameters:
                 x_val (list, np.array): Input data for validation.
                 y_val (list, np.array): Output data for validation.
```

## aironsuit/trainers/trainers_torch.py

```diff
@@ -1,21 +1,21 @@
-import os
-import glob
 from pytorch_lightning import Trainer
 from torch.utils.data import DataLoader, TensorDataset
 import torch
 
 
 def fit(module, x_train, y_train=None, x_val=None, y_val=None, best_module_name=None, **kwargs):
 
     # Invoke trainer
     kwargs_ = kwargs.copy()
     if 'epochs' in kwargs_.keys():
         kwargs_['max_epochs'] = kwargs_['epochs']
         del kwargs_['epochs']
+    if 'verbose' in kwargs_.keys():
+        del kwargs_['verbose']
     trainer = Trainer(**kwargs_)
 
     # Converting numpy arrays to Tensor datasets
     device = set_up_cuda()[0]
     training_dataset = array_to_tensor_dataset(x_train, y_train, device=device)
     if x_val and y_val:
         val_dataset = array_to_tensor_dataset(x_val, y_val, device=device)
```

## Comparing `aironsuit-0.1.8.dist-info/LICENSE` & `aironsuit-0.1.9.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `aironsuit-0.1.8.dist-info/METADATA` & `aironsuit-0.1.9.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,21 +1,20 @@
 Metadata-Version: 2.1
 Name: aironsuit
-Version: 0.1.8
+Version: 0.1.9
 Summary: A model wrapper for automatic model design and visualization purposes.
 Home-page: https://github.com/AtrejuArtax/aironsuit
 Author: Claudi Ruiz Camps
 Author-email: claudi_ruiz@hotmail.com
 License: BSD
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: BSD License
 Classifier: Operating System :: OS Independent
 Description-Content-Type: text/markdown
-License-File: LICENSE
 Requires-Dist: sklearn
 Requires-Dist: hyperopt
 
 # AIronSuit
 
 AIronSuit (Beta) is a Python library for automatic model design/selection and visualization purposes built to work with 
 [tensorflow](https://github.com/tensorflow/tensorflow) (or [pytorch](https://github.com/pytorch/pytorch) in the future) 
@@ -31,15 +30,15 @@
 2. Parallel computing for multiple models across multiple GPUs when using a k-fold approach.
 3. Built-in model trainer that saves training progression to be visualized with 
    [TensorBoard](https://github.com/tensorflow/tensorboard).
 4. Machine learning tools from [AIronTools](https://github.com/AtrejuArtax/airontools): `model_constructor`, `custom_block`, 
    `layer_constructor`, preprocessing utils, etc.
 5. Flexibility: the user can replace AIronSuit components by a user customized one. For instance,
     the model constructor can be easily replaced by a user customized one.
-   
+
 ### Installation
 
 `pip install aironsuit`
 
 ### Example
 
 ``` python
```

## Comparing `aironsuit-0.1.8.dist-info/RECORD` & `aironsuit-0.1.9.dist-info/RECORD`

 * *Files 22% similar despite different names*

```diff
@@ -1,17 +1,17 @@
 aironsuit/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 aironsuit/backend.py,sha256=d5mFUm6PF1CqCT06OZTHSHvXra0aqDaYECF9C0ZIvLE,183
 aironsuit/model_designers.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-aironsuit/suit.py,sha256=4advzdtwmj9C1giSqvIiHe_CIBrRnrJV_UwJ93Zt1w4,18599
+aironsuit/suit.py,sha256=KZTmJCvB_YTJuZrfhVvycFAElflJ0aAkM8OORvKbfak,18882
 aironsuit/callbacks/__init__.py,sha256=oVLjj15jRS0vQ1I2GU1asw6m1zJjNZ6nzj5mhqifNoY,44
-aironsuit/callbacks/callbacks.py,sha256=GctFDpVEDdLO1I7nBb6aEW81ZD73Y09lHZUipXz2vKs,1400
-aironsuit/callbacks/callbacks_tf.py,sha256=Qf36O_3O222XpSq15toprWxqiPawfjIsopZ2WDH3XXA,1763
-aironsuit/callbacks/callbacks_torch.py,sha256=Khr7xV_kSKHY80LvwRZjzyOpi9KtCiaMYvNoWfd5UgI,1102
+aironsuit/callbacks/callbacks.py,sha256=raRmsPkwGzTkxMJK_nE3d__UKFpVVFRG9ohg7nmUExs,1390
+aironsuit/callbacks/callbacks_tf.py,sha256=iYA8LTGbiKkeExOCN2tUqp4nWtXW9WBoBYQY6BJTe0c,1763
+aironsuit/callbacks/callbacks_torch.py,sha256=SJPZ2bka0GhspO7cZiTm1EVukasJ-r6jce0wxIZZGIo,1102
 aironsuit/trainers/__init__.py,sha256=Z758YHiEF9byn31jzavVUh-1LWyFK-Jyae7guDnXgLw,42
-aironsuit/trainers/trainers.py,sha256=1oBrT_6UNY49k8enGLPLFbmiLWNJwD9wOnKKGZsJwJ8,2242
+aironsuit/trainers/trainers.py,sha256=c5kuRt5U-IPma_vXx1Cxu4FKMgyWUHh6rZz9ojzQJcs,2321
 aironsuit/trainers/trainers_tf.py,sha256=UIhl6aJxqcflvZAjeeWTNXtmW7HEenWyUp29lKtPC8M,830
-aironsuit/trainers/trainers_torch.py,sha256=VzbTMqltKwv4SiqliQ9U5JagBM546sGHRleWAo70rtQ,1646
-aironsuit-0.1.8.dist-info/LICENSE,sha256=pbNgO8-4dnOOnpu88HUZXmqkA67muI12M2vgUjK625g,1525
-aironsuit-0.1.8.dist-info/METADATA,sha256=zH4riRBS_5YEXdn2m64jh8u7gmNR5EVeRMw3tzrHmtM,4433
-aironsuit-0.1.8.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
-aironsuit-0.1.8.dist-info/top_level.txt,sha256=UgZodKxruNsAUsaY6VgVS7jmUSvpkzG8SXN-KXKDETI,10
-aironsuit-0.1.8.dist-info/RECORD,,
+aironsuit/trainers/trainers_torch.py,sha256=cJjFutyYEUsG4F0dywT8zRwubL-PLzCuZNNY8iF9LNs,1691
+aironsuit-0.1.9.dist-info/LICENSE,sha256=pbNgO8-4dnOOnpu88HUZXmqkA67muI12M2vgUjK625g,1525
+aironsuit-0.1.9.dist-info/METADATA,sha256=vVSGTBmG3br0hqoH634mspurD2ayxOWKb1BRRreJzrU,4408
+aironsuit-0.1.9.dist-info/WHEEL,sha256=OqRkF0eY5GHssMorFjlbTIq072vpHpF60fIQA6lS9xA,92
+aironsuit-0.1.9.dist-info/top_level.txt,sha256=UgZodKxruNsAUsaY6VgVS7jmUSvpkzG8SXN-KXKDETI,10
+aironsuit-0.1.9.dist-info/RECORD,,
```

